var heyModal=function(){"use strict";function e(t){for(var s,i,n=Array.prototype.slice.call(arguments,1);n.length;){s=n.shift();for(i in s)s.hasOwnProperty(i)&&("object"==typeof t[i]&&t[i]&&"[object Array]"!==Object.prototype.toString.call(t[i])&&"object"==typeof s[i]&&null!==s[i]?t[i]=e({},t[i],s[i]):t[i]=s[i])}return t}function t(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}function s(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,i=null,n=null,o=function(){return e.apply(s,n)};return function(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];n=s,clearTimeout(i),i=setTimeout(o,t)}}try{var i=new window.CustomEvent("test");if(i.preventDefault(),i.defaultPrevented!==!0)throw new Error("Could not prevent default")}catch(e){var n=function(e,t){var s,i;return t=t||{bubbles:!1,cancelable:!1,detail:void 0},s=document.createEvent("CustomEvent"),s.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i=s.preventDefault,s.preventDefault=function(){i.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(e){this.defaultPrevented=!0}},s};n.prototype=window.Event.prototype,window.CustomEvent=n}var o=e;return function(){var e=0,i={classes:{modal:["modal"],modalDialog:["modal__dialog"],modalHeader:["modal__header"],modalBody:["modal__body"],modalContent:["modal__content"],modalClose:["modal__close"],modalCloseBtnText:["modal__close-text"],modalTitle:["modal__title"],confirm:["modal__confirm"],confirmYes:["btn","btn--positive"],confirmCancel:["btn","btn--negative"],visibleClass:["modal--is-visible"],bodyOverflowClass:["modal-body-no-scroll"]}},n={options:i,body:null,elem:null,target:null,confirm:!1,events:{open:new CustomEvent("heyOpen"),close:new CustomEvent("heyClose")},content:{title:null,body:null},shared:{isScrollable:null,scrollbarWidth:null,testResults:null},init:function(){this.body=document.querySelector("body"),this.id=e,this.tests(),this.setScrollable(),this.setScrollbarWidth(),this.checkClasses(),this.elem.hasAttribute("data-hey-confirm")&&(this.confirm=!0),this.confirm||(this.setTarget(),this.checkTarget()),this.build(),this.removeTarget(),this.shared.testResults.flexbox||this.setMaxHeight(),this.bindEvents()},tests:function(){if(!this.shared.testResults){var e={};e.transitions="transition"in document.documentElement.style||"WebkitTransition"in document.documentElement.style,e.flexbox="flex-wrap"in document.documentElement.style,this.shared.testResults=e}},on:function(e,t){this.comp.wrapper.addEventListener(e,t)},checkClasses:function(){var e=this;try{if(!Object.keys(this.options.classes).every(function(t){return e.options.classes[t]instanceof Array}))throw new Error("Classes must be set as arrays, e.g. confirm: ['class-one']")}catch(e){console.error(e)}},build:function(){var e,s,i,n,o,a,r,l={},c=this.options.classes;if(l.wrapper=document.createElement("div"),l.wrapper.classList.add("modal"),l.wrapper.setAttribute("aria-hidden","true"),l.dialog=document.createElement("div"),(e=l.dialog.classList).add.apply(e,t(c.modalDialog)),l.dialog.setAttribute("role","dialog"),l.dialog.setAttribute("aria-labelledby","modal__title-"+this.id),l.header=document.createElement("div"),(s=l.header.classList).add.apply(s,t(c.modalHeader)),l.title=document.createElement("h3"),(i=l.title.classList).add.apply(i,t(c.modalTitle)),l.title.id="modal__title-"+this.id,l.inner=document.createElement("div"),(n=l.inner.classList).add.apply(n,t(c.modalBody)),l.inner.style.overflow="auto",l.body=document.createElement("div"),(o=l.body.classList).add.apply(o,t(c.modalContent)),l.inner.appendChild(l.body),l.closeBtn=document.createElement("button"),(a=l.closeBtn.classList).add.apply(a,t(c.modalClose)),l.closeBtn.setAttribute("type","button"),l.closeBtn.setAttribute("aria-label","Close"),l.closeText=document.createElement("span"),(r=l.closeText.classList).add.apply(r,t(c.modalCloseBtnText)),l.closeText.innerHTML="Close",l.closeBtn.appendChild(l.closeText),this.confirm){var d,h,p;l.confirm=document.createElement("div"),(d=l.confirm.classList).add.apply(d,t(c.confirm)),l.confirmYes=document.createElement("a"),l.confirmYes.innerHTML="Proceed",l.confirmYes.setAttribute("href",this.elem.getAttribute("href")),(h=l.confirmYes.classList).add.apply(h,t(c.confirmYes)),l.confirmCancel=document.createElement("button"),l.confirmCancel.innerHTML="Cancel",l.confirmCancel.setAttribute("data-hey-close",""),(p=l.confirmCancel.classList).add.apply(p,t(c.confirmCancel)),l.confirm.appendChild(l.confirmYes),l.confirm.appendChild(l.confirmCancel),l.inner.appendChild(l.confirm)}l.header.appendChild(l.title),l.header.appendChild(l.closeBtn),l.dialog.appendChild(l.header),l.dialog.appendChild(l.inner),l.wrapper.appendChild(l.dialog),this.comp=l,this.populate(),this.body.appendChild(l.wrapper)},populate:function(){var e=this,t={};for(var s in this.content){if(t[s]=this.content[s],!this.content[s])if(e.target){var i=e.target.querySelector("[data-hey-"+s+"]");i&&(t[s]=i.innerHTML)}else e.elem.hasAttribute("data-hey-"+s)&&(t[s]=e.elem.getAttribute("data-hey-"+s));this.comp[s].innerHTML=t[s]}this.content=t},setMaxHeight:function(){var e=getComputedStyle(this.comp.wrapper),t=this.comp.header.offsetHeight,s=this.comp.wrapper.offsetHeight;this.comp.inner.style.maxHeight="calc("+s+"px - ("+e.paddingTop+" + "+e.paddingTop+") - "+t+"px)"},setTarget:function(){this.elem.hasAttribute("data-hey")?this.target=document.querySelector(this.elem.getAttribute("data-hey")):this.elem.hasAttribute("href")&&this.elem.getAttribute("href").indexOf("#")>=0&&(this.target=document.querySelector(this.elem.getAttribute("href")))},checkTarget:function(){var e=void 0;try{if(!this.target||!this.target.nodeType)throw e=!1,new Error("No modal target given.");e=!0}catch(e){console.error(e)}return e},removeTarget:function(){this.target&&this.target.parentElement.removeChild(this.target)},bindEvents:function(){var e=this;window.addEventListener("resize",s(this.setScrollable.bind(this),500)),this.shared.testResults.flexbox||window.addEventListener("resize",s(this.setMaxHeight.bind(this),200)),this.comp.wrapper.addEventListener("touchmove",function(e){e.preventDefault()},!1),this.comp.body.addEventListener("touchmove",function(e){e.stopPropagation()},!1),this.elem.addEventListener("click",function(t){t.preventDefault(),e.open()}),this.comp.wrapper.addEventListener("click",this.close.bind(this)),this.comp.closeBtn.addEventListener("click",this.close.bind(this)),this.comp.dialog.addEventListener("click",function(e){e.stopPropagation()});var t=this.comp.dialog.querySelector("[data-hey-close]");t&&t.addEventListener("click",function(t){t.preventDefault(),e.close()}),this.comp.wrapper.addEventListener("keydown",function(t){switch(t.keyCode){case 27:e.close();break;case 9:t.shiftKey?e.firstFocusable===document.activeElement&&(t.preventDefault(),e.lastFocusable.focus()):e.lastFocusable===document.activeElement&&(t.preventDefault(),e.firstFocusable.focus())}})},setScrollable:function(){var e=document.body.offsetHeight>window.innerHeight,t=document.documentElement.clientWidth===window.innerWidth;this.shared.isScrollable=e&&!t},open:function(){function e(){this.setFocus(),this.comp.wrapper.removeEventListener("transitionEnd",e)}var s;(s=this.comp.wrapper.classList).add.apply(s,t(this.options.classes.visibleClass)),this.setPageScroll(!1),this.comp.wrapper.setAttribute("aria-hidden","false"),this.setLastFocusedElem(),this.comp.wrapper.dispatchEvent(this.events.open),this.body.style.marginRight=this.shared.isScrollable?this.shared.scrollbarWidth+"px":"",this.shared.testResults.transitions&&this.comp.wrapper.addEventListener("transitionend",e.bind(this))},setFocus:function(){var e=this.comp.dialog.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]');this.firstFocusable=e[0],this.lastFocusable=e[e.length-1],this.firstFocusable.focus()},setLastFocusedElem:function(){this.lastFocused=document.activeElement},close:function(){var e,s=this;(e=this.comp.wrapper.classList).remove.apply(e,t(this.options.classes.visibleClass)),this.lastFocused.focus();var i=function e(){s.setPageScroll(!0),s.body.style.marginRight=0,s.comp.wrapper.removeEventListener("transitionend",e),s.comp.wrapper.setAttribute("aria-hidden","true"),s.comp.wrapper.dispatchEvent(s.events.close)};this.shared.testResults.transitions?this.comp.wrapper.addEventListener("transitionend",i):i()},setPageScroll:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]){var e;(e=this.body.classList).remove.apply(e,t(this.options.classes.bodyOverflowClass))}else{var s;(s=this.body.classList).add.apply(s,t(this.options.classes.bodyOverflowClass))}},setScrollbarWidth:function(){if(!this.shared.scrollbarWidth){var e=document.createElement("div");e.style.width=100,e.style.height=100,e.style.overflow="scroll",e.style.position="absolute",e.style.top=-9999,this.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;this.body.removeChild(e),this.shared.scrollbarWidth=t}}};return function(t,s){e+=1;var a=o({},i,s),r=o(Object.create(n),{elem:t},{options:a});return r.init(),r}}()}();
